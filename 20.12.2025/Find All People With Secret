class Solution(object):
    def findAllPeople(self, n, meetings, firstPerson):
        from collections import defaultdict

        secret = set([0, firstPerson])

        time_map = defaultdict(list)
        for x, y, t in meetings:
            time_map[t].append((x, y))

        for t in sorted(time_map.keys()):
            graph = defaultdict(list)
            participants = set()

            for x, y in time_map[t]:
                graph[x].append(y)
                graph[y].append(x)
                participants.add(x)
                participants.add(y)

            queue = []
            for p in participants:
                if p in secret:
                    queue.append(p)

            visited = set(queue)
            while queue:
                person = queue.pop()
                for nei in graph[person]:
                    if nei not in visited:
                        visited.add(nei)
                        queue.append(nei)

            secret.update(visited)

        return list(secret)
